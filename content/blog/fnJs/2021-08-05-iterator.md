---
title: '이터러블/이터레이터 프로토콜'
date: 2021-08-05 16:21:13
category: '함수형프로그래밍'
draft: false
---

## 이터러블/이터레이터 프로토콜
- 이터러블: 이터레이터를 리턴하는 `[Symbol.iterator]()` 를 가진 값
- 이터레이터: { value, done } 객체를 리턴하는 next() 를 가진 값
- 이터러블/이터레이터 프로토콜: 이터러블을 for...of, 전개 연산자 등과 함께 동작하도록한 규약

## 예제

### Array를 통해 알아보기

```javascript
log('Arr -----------');
const arr = [1, 2, 3];
let iter1 = arr[Symbol.iterator]();
for (const a of iter1) log(a);
// result 1, 2, 3
```

### Set을 통해 알아보기

```javascript
log('Set -----------');
const set = new Set([1, 2, 3]);
for (const a of set) log(a);
// result => 1, 2, 3
```

### Map을 통해 알아보기
```javascript
log('Map -----------');
const map = new Map([['a', 1], ['b', 2], ['c', 3]]);
for (const a of map.keys()) log(a); // result => a, b, c 
for (const a of map.values()) log(a); // result => 1, 2, 3
for (const a of map.entries()) log(a); // result => ["a", 1], ["b", 2], ["c", 3]
```

- 이터러블 즉 `[Symbol.iterator]()`를 가진 값 안에는 next() 메소드가 있다.
- 이터레이터 안에 next() 메소드를 실행하면 `{value: 값, done: false}`이렇게 생긴 객체를 리턴하는데 done에 값이 true가 되면 순환이 끝난 시점이다.


## 사용자 정의 이터러블/이터레이터
```javascript
const iterable = {
  [Symbol.iterator]() {
    let i = 3;
    return {
      next() {
        // 순회가 끝나면 done: true로 리턴
        return i == 0 ? {done: true} : {value: i--, done: false}
      },
      [Symbol.iterator]() {return this;} // 어디에서든 계속해서 next를 실행할 수 있도록 설정
    }
  }
};
let iterator = iterable[Symbol.iterator]();
// for (const a of iterator) log(a); => return 1, 2, 3;

const arr2 = [1, 2, 3];
let iter2 = arr2[Symbol.iterator]();
// iter2.next(); // 이터레이터를 진행하다가 순회도 가능!
// log(iter2[Symbol.iterator]() == iter2); // return true
for (const a of arr2) log(a);
```
- 이터러블/이터레이터 프로토콜은 자바스크립트에서 여러가지가 따르고 있는 규약이다.

## 전개 연산자
```javascript
const a = [1, 2];
const arr = [1, 2, 3];
const set = new Set([1, 2, 3]);
const map = new Map([['a', 1], ['b', 2], ['c', 3]]);

log([...a, ...arr, ...set, ...map.keys()]); // result => [1, 2, 3, 1, 2, 3, 1, 2, 3, "a", "b", "c"]
```
- 전개 연산자 역시 이터러블/이터레이터 프로토콜을 따른다.


출처
- https://www.inflearn.com/users/31989
